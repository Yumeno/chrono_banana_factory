# Chrono Banana Factory 🍌⏰

**時系列画像生成ツール** - Nano Banana Hackathon 2025 プロジェクト

## 概要

Chrono Banana Factoryは、時間の経過を表現した一連の画像を生成する革新的なツールです。nanobanana API (Google Gemini 2.5 Flash Image Preview API) を活用し、ストーリーテリングや動画制作のための連続した画像を簡単に作成できます。

## 例えば…

- 「銀行強盗が現れた！壮絶なカーチェイスの果てに逮捕…」こんな物語のストーリーボードイラストが簡単に作れる！
- 「都市の上空、疾走するバイクの引きのショットからスタートして、ドローンショットで登場人物にズームイン」こんなシーンの、動画生成AI向けの開始画像・終了画像を簡単に作れる！
- 「ご飯を食べてる女の子の３時間後の様子」「観光地の春夏秋冬の様子」「おいしい料理が、2時間前にどんな状態だったか」など、普通なら無理な指示も対応可能！

### 主な特徴

- **🎬 時系列画像生成**: 時間の経過を表現した複数の画像を一度に生成
- **⏱️ 高度な時間制御**: 現在のみ、シーン開始、シーン終了、カスタム時間範囲（過去と未来）の4つのモード
- **📝 ストーリーエンハンス**: AI（Gemini 2.5 Flash Lite）によるストーリー自動生成・改善
- **🎨 画風選択**: 写真、水彩画、油絵、3DCG、アニメ、漫画、フィギュアの7つのスタイル
- **🖼️ 参照画像機能**: 最大15枚の参照画像を使用した画像編集・生成
- **📐 アスペクト比制御**: 正方形、横長、縦長、ワイドなど多様な比率に対応
- **♻️ 画像再利用**: 生成した画像を入力画像として再利用可能

## 技術スタック

- **フレームワーク**: Next.js 15.5.2（App Router）
- **言語**: TypeScript
- **スタイリング**: Tailwind CSS
- **UIコンポーネント**: shadcn/ui
- **AI API**: 
  - Gemini 2.5 Flash Image Preview（画像生成）
  - Gemini 2.5 Flash Lite（テキスト生成）
- **画像処理**: HTML Canvas API

## セットアップ

### 必要条件

- Node.js 18以上
- npm または yarn
- Google AI Studio APIキー

### インストール手順

1. リポジトリをクローン
```bash
git clone https://github.com/Yumeno/chrono_banana_factory.git
cd chrono_banana_factory
```

2. 依存関係をインストール
```bash
npm install
```

3. 環境変数を設定
`.env.local`ファイルを作成し、APIキーを設定：
```env
GEMINI_API_KEY=your_api_key_here
```

4. 開発サーバーを起動
```bash
npm run dev
```

5. ブラウザで [http://localhost:3000](http://localhost:3000) を開く

## 使い方

### 基本的な使い方

1. **ストーリーテキストを入力**: テキストエリアにアイデアを簡単に入力
2. **参照画像を追加**: 登場させたいキャラクターや背景の画像があれば登録
3. **エンハンスボタンを押す**: アイデアと参照画像に基づいてテキストエリアにエンハンスされたプロンプトを生成
2. **画像数を設定**: 生成したい画像の枚数を選択（1-10枚）
3. **時間制御を設定**: 時間の表現方法を選択
4. **画風を選択**: お好みのアートスタイルを選択
5. **画像を生成**: 「Generate Scenes」ボタンをクリック

### ストーリーエンハンス機能

AIがストーリーを自動生成・改善する機能：

1. **Story モード**: シーン区切りのはっきりした物語の生成。（絵本・ストーリーボード生成向け）
2. **Video モード**: 被写体の芝居やカメラワーク等も含んだ動画向けのシーン記述の生成。（各カットの開始・終了フレーム生成向け）
3. **Moment モード**: 単一シーンの詳細な描写生成 （一般的な画像生成のプロンプトエンハンス）

参照画像がある場合、AIが画像の要素（キャラクター、背景、オブジェクト等）を創造的に物語に組み込みます。

### 時間制御モード

#### 1. Standard（標準）
- 単一の時点の画像を生成。時間要素なし。
- 一般的な画像生成と同じ挙動になります。

#### 2. Scene Start（シーン開始）
- 各シーンの開始時点を生成。物語の始まりや新しい場面の導入に最適。
- 生成枚数を設定すると、テキストエリアに記述されている内容について指定枚数の画像を生成させる

#### 3. Scene End（シーン終了）
- 各シーンの終了時点を生成。クライマックスや結末の表現に適している。
- 生成枚数を設定すると、テキストエリアに記述されている内容について指定枚数の画像を生成させる

#### 4. Custom Future/Past（カスタム時間範囲）
具体的な時間範囲を指定して変化を表現：
- 値が正の場合、テキストエリアに記述されている内容より未来
- 値が負の場合、テキストエリアに記述されている内容より過去
- 時間単位：秒、分、時間、日、週、月、年
- 生成枚数を設定すると、指定した時間範囲を生成枚数で分割し、タイムラプス的な画像を生成させる
- 例：「1年を4分割」→ 春夏秋冬の変化を表現

### 参照画像の活用

- **キャラクター画像**: ストーリーエンハンスでは物語の登場人物として活用
- **背景画像**: ストーリーエンハンスではシーンの舞台として使用
- **オブジェクト画像**: ストーリーエンハンスでは小道具や重要アイテムとして登場
- **生成画像の再利用**: 「Use as Input」で生成画像を参照画像として追加
- **上限**: 最大15枚まで追加できる

## プロジェクト構成

```
chrono_banana_factory/
├── src/
│   ├── app/              # Next.js App Router
│   │   ├── page.tsx      # メインページ
│   │   └── layout.tsx    # レイアウト
│   ├── components/       # UIコンポーネント
│   │   ├── story/        # ストーリー関連
│   │   ├── time/         # 時間制御関連
│   │   ├── style/        # 画風選択関連
│   │   └── ui/           # shadcn/ui基本コンポーネント
│   ├── lib/
│   │   ├── api/          # API関連
│   │   │   ├── nanoBananaClient.ts    # Gemini API クライアント
│   │   │   └── suggestionGenerator.ts  # ストーリー生成
│   │   └── utils/        # ユーティリティ関数
│   └── types/            # TypeScript型定義
├── public/               # 静的ファイル
└── .env.local           # 環境変数（要作成）
```

## 主要コンポーネント

### StoryTextInput
ストーリーテキストの入力とエンハンス機能を提供

### TimePointControls  
時間制御の設定（モード選択、時間範囲、分割数）

### ArtStyleSelector
7つの画風から選択可能な折りたたみ式セレクター

### ImageUploadArea
参照画像のアップロード（ドラッグ&ドロップ対応）

### GeneratedScenes
生成された画像の表示とダウンロード機能

## トラブルシューティング

### APIキーエラー
- Google AI Studioでキーを取得: https://aistudio.google.com/apikey
- `.env.local`ファイルにキーを正しく設定

### 画像生成エラー
- プロンプトが具体的で詳細か確認
- 参照画像のフォーマットが対応しているか確認（PNG, JPEG, WebP）
- APIの日次制限に達していないか確認

### 時間制御が機能しない、指定通りの枚数が出力されない
- モデルのレスポンスはやや不安定なため複数回試行錯誤してもらいたい

## 開発者向け情報

### ビルド
```bash
npm run build
```

### テスト実行
```bash
npm test
```

### 型チェック
```bash
npm run type-check
```

### リント
```bash
npm run lint
```

## ライセンス

MIT License

## 貢献

プルリクエストを歓迎します！大きな変更の場合は、まずissueを開いて変更内容を議論してください。

## 謝辞

- Google DeepMind - Nano Banana Hackathon主催
- Gemini API - 強力な画像・テキスト生成機能の提供
- Next.js & Vercel - 優れた開発体験とホスティング
- shadcn/ui - 美しいUIコンポーネント

## 連絡先

- GitHub: [@Yumeno](https://github.com/Yumeno)
- プロジェクト: [Chrono Banana Factory](https://github.com/Yumeno/chrono_banana_factory)

---

🍌 **Nano Banana Hackathon 2025** - 時間を超えた創造性を解き放て！